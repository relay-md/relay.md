{% extends 'layout.html' %} {% block title %}{{ name }} {% endblock %}
{% block content %}
.mt-5.mb-5
 .columns
  .column.is-8.is-offset-2
   h1.title.is-1 Team Overview
   p.block You can subscribe to individual topics of each team by clicking the topic. You will get new documents in those topics into your Vault automatically.
   p.block
    span.tag.is-primary Subscribed
    span.tag Unsubscribed
    span.text-icon
     span.icon
      i.fas.fa-globe
     span Public
    span.text-icon
     span.icon
      i.fas.fa-lock
     span Private
   table.table.is-fullwidth.block
    thead
     th Team
     th Topics
     th Owner
     th Creation Date
     th Type
     td(data-tooltip="Join")
      i.fas.fa-sign-in
     td(data-tooltip="Read")
      i.fas.fa-glasses
     td(data-tooltip="Post")
      i.fas.fa-pencil
     td(data-tooltip="Modify")
      i.fas.fa-edit
     td(data-tooltip="Create Topics")
      i.fas.fa-plus
     th Control
    tbody
     {% for team in teams %}
     tr
      td
       {%if team.name == "_"%}
       .icon-text
        span.tag.is-primary.icon
          i.fas.fa-globe
        span Global
       {%else%}
       tt {{team.name}}
       {%endif%}
      td
       {% if team.is_private %}
       span.is-italic confidential
       {% else %}
       {% for topic in team.topics %}
       // FIXME: this is super inefficient
       {% if user and user_repo.is_subscribed(user, team, topic) %}
       a(href="{{url_for('unsubscribe', team_topic_name=topic.name+'@'+team.name)}}" alt="Subscribe to topic")
        p.tag.is-primary {{topic.name}}
       {% else %}
       a(href="{{url_for('subscribe', team_topic_name=topic.name+'@'+team.name)}}")
        p.tag {{topic.name}}
       {% endif %}
       {% endfor %}
       {% endif %}
      td {{team.user.username}}
      td {{team.created_at}}
      td
       span
       {% if team.is_public %}
       span.icon
        i.fas.fa-globe
       {% else %}
       span.icon
        i.fas.fa-lock
       {% endif %}
      {% if user %}
      {% for perm in [Permissions.can_join, Permissions.can_read, Permissions.can_post, Permissions.can_modify, Permissions.can_create_topics] %}
      td
       {% if perm in Permissions(team.public_permissions) %}
       i.fa.fa-check
        {% else %}
       i.fa.fa-times
       {% endif %}
      {% endfor %}
      td
       .field.has-addons
        {% if not team.is_private %}
        p.control
          {% if user_repo.is_member(user, team) %}
          a(href="{{url_for('leave', team_name=team.name)}}").button
            span.icon.is-small
              i.fas.fa-signature
            span Leave
          {% else %}
          {% if team.is_public %}
          a(href="{{url_for('join', team_name=team.name)}}").button
            span.icon.is-small
              i.fas.fa-signature
            span Join Team
          {% endif %}
          {% endif %}
        {% endif %}
        {% if user and team.user_id == user.id %}
        p.control
          a(href="{{url_for('settings', team_name=team.name)}}").button
            span.icon.is-small
              i.fas.fa-edit
        {% endif %}
      {% endif %}
     {% endfor %}
{% endblock %}
